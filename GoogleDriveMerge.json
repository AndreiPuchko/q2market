{
 "modules": [
  {
   "name": "_after_data_loaded",
   "script": "?locals()[\"form\"].get_current_record()",
   "comment": "",
   "last_line": "1",
   "q2_time": "20240625134157",
   "q2_mode": "u"
  },
  {
   "name": "_autorun",
   "script": "# run_form(\"datas\")\r\n\r\n?os.path.isdir(self.q2market_path)\r\n?os.path.abspath(self.q2market_path)",
   "comment": "",
   "last_line": "4",
   "q2_time": "20240617135100",
   "q2_mode": "u"
  },
  {
   "name": "_e_control",
   "script": "if mem._name == \"sheet_keys\":\r\n    if form.controls[-1].get(\"column\") == \"key_value\":\r\n        mem.controls.extend(get_form(\"_test_sheet_keys\").controls)",
   "comment": "",
   "last_line": "4",
   "q2_time": "20240625092540",
   "q2_mode": "u"
  },
  {
   "name": "_move",
   "script": "binary_name = \"GoogleDriveMerge\"\r\ndist_folder = os.path.abspath(\"make/dist\")\r\nfor x in os.listdir(dist_folder):\r\n    if os.path.isfile(os.path.join(dist_folder, x)):\r\n        shutil.move(os.path.join(dist_folder, x), os.path.join(dist_folder, binary_name)+\"/\")",
   "comment": "",
   "last_line": "5",
   "q2_time": "20240324204711",
   "q2_mode": "i"
  },
  {
   "name": "_test_",
   "script": "id = \"19xpPvbIqVZ2ITveS-DUI3vwSBnSWPXc3qWc1NYtRREs\"\r\n\r\nself.heap.gd.open_sheets()\r\n\r\nsh = self.heap.gd.google_sheets.open_by_key(id)\r\n\r\nworksheet = sh.get_worksheet(0)\r\n\r\nallrows = worksheet.get_all_values()\r\n\r\n\r\nfor x in allrows:\r\n    ?x",
   "comment": "",
   "last_line": "13",
   "q2_time": "20240324204711",
   "q2_mode": "i"
  },
  {
   "name": "_test_2",
   "script": "try:\r\n    1+\"\"\r\nexcept:\r\n    pass",
   "comment": "",
   "last_line": "2",
   "q2_time": "20240324204711",
   "q2_mode": "i"
  },
  {
   "name": "_test_autorun",
   "script": "# def ensure_empty_pk(table=\"\", field2=\"name\"):\r\n    # if myapp.db_data.table(table).row_count() <=0:\r\n        # insert(table, {field2: \"-\"})\r\nensure_empty_pk(\"students\", {\"firstname\":\"-\"})",
   "comment": "",
   "last_line": "4",
   "q2_time": "20240625120211",
   "q2_mode": "u"
  },
  {
   "name": "_test_utils",
   "script": "def get_student(firstname,lastname, date_of_birth, id=None):\r\n    sql = f\"\"\"select * \r\n                from students \r\n                where lastname='{lastname}' and firstname='{firstname}' and date_of_birth='{date_of_birth}' \r\n                \"\"\"\r\n    if id is not None:\r\n        sql = f\"{sql} and id<>{id}\"\r\n    return q2cursor(sql).record(0)",
   "comment": "",
   "last_line": "8",
   "q2_time": "20240624223617",
   "q2_mode": "u"
  },
  {
   "name": "_tmp",
   "script": "?globals().get(\"RETURN\")",
   "comment": "",
   "last_line": "1",
   "q2_time": "20240624192737",
   "q2_mode": "i"
  },
  {
   "name": "autorun",
   "script": "from q2googledrive import q2googledrive\r\nself.heap.gd = None\r\n\r\n\r\ndef gd_connect(servicekey, create_servicekey=True):\r\n    if not const.servicekey:\r\n        q2mess(f\"\"\"\u0421\u0435\u0440\u0432\u0438\u0441\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d!!!<br><br>\r\n                        {\"\u0414\u043b\u044f \u0432\u0432\u043e\u0434\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u043e \u043e\u043a\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a.<br>\" if create_servicekey else \"\"}\r\n                        <br>\r\n                        \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f: \r\n                        <a href=\"https://docs.google.com/document/d/1PDdopxqnmD9iJ7aJ5c2dVEjuYqGZ6Uoq-aqfAiRRac4/edit?usp=sharing\">\r\n                            \u041e\u0442\u043a\u0440\u044b\u0442\u044c\r\n                        </a>\r\n \"\"\")\r\n        if create_servicekey:\r\n            run_form(\"settings\")\r\n            servicekey = const.servicekey\r\n    if not const.servicekey:\r\n        return False\r\n    try:\r\n        self.heap.gd = q2googledrive(service_account_key=const.servicekey)\r\n        return True\r\n    except Exception as error:\r\n        q2mess(\"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c \u0413\u0443\u0433\u043b!\")\r\n    return False\r\n\r\n\r\nself.heap.gd_connect = gd_connect\r\n\r\nself.heap.gd_connect(const.servicekey)",
   "comment": "",
   "last_line": "31",
   "q2_time": "20240616181403",
   "q2_mode": "u"
  },
  {
   "name": "manifest",
   "script": "myapp.app_title = \"GoogleDriveMerge\"\nmyapp.app_description = \"Merges one row from Google Sheet into Google Document template\"\nmyapp.app_url = \"https://raw.githubusercontent.com/AndreiPuchko/q2market/main/GoogleDriveMerge\"",
   "comment": "",
   "last_line": "3",
   "q2_time": "20240324204711",
   "q2_mode": "i"
  },
  {
   "name": "on_new_tab",
   "script": "while not myapp.dev_mode:\r\n    run_form(\"datas\")",
   "comment": "",
   "last_line": "2",
   "q2_time": "20240331110906",
   "q2_mode": "u"
  },
  {
   "name": "row_extender",
   "script": "def row_extender(data, uid):\r\n    data['B'] = \"Row Extender\"",
   "comment": "",
   "last_line": "2",
   "q2_time": "20240616193401",
   "q2_mode": "u"
  },
  {
   "name": "version",
   "script": "self.app_version = '2024-06-25 22:23:31'",
   "comment": "",
   "last_line": "0",
   "q2_time": "20240625222331",
   "q2_mode": "u"
  }
 ],
 "forms": [
  {
   "name": "_test_sheet_keys",
   "title": "sheet_keys",
   "seq": "6",
   "menu_path": "",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "",
   "toolbar": "",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "sheet_keys",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240623182112",
   "q2_mode": "u"
  },
  {
   "name": "_test_sheet_students",
   "title": "\u0421\u0442\u0443\u0434\u0435\u043d\u0442\u044b",
   "seq": "7",
   "menu_path": "\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u0438",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "",
   "toolbar": "",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "students",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "",
   "after_form_show": "",
   "before_crud_save": "import _test_utils\r\n\r\nif get_student(mem.s.firstname, mem.s.lastname, mem.s.date_of_birth, None if mem.crud_mode != \"EDIT\" else mem.r.id).get(\"firstname\"):\r\n    q2mess(f\"\u0422\u0430\u043a\u043e\u0439 \u0441\u0442\u0443\u0434\u0435\u043d\u0442 \u0443\u0436\u0435 \u0435\u0441\u0442\u044c - \u043a\u043e\u0434: <font color=red><b>{mem.r.id}</b>\")\r\n    return False",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240624223447",
   "q2_mode": "u"
  },
  {
   "name": "datas",
   "title": "\u0422\u0430\u0431\u043b\u0438\u0446\u044b",
   "seq": "1",
   "menu_path": "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "",
   "toolbar": "*",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "datas",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "if mem.crud_mode == \"NEW\":\r\n    mem.s.key_column = 1\r\n    mem.s.first_row = 2\r\n# if mem.crud_mode != \"NEW\":\r\n    # mem.w.name.set_visible(False)\r\n    # mem.w.name.label.set_visible(False)\r\n    # mem.w.select_file.set_visible(False)\r\n# mem.s.name = \"Pri\"",
   "after_form_show": "",
   "before_crud_save": "if num(mem.s.datasource) <=1:  #Google \r\n    mem.s.local_path = \"\"\r\nelse:\r\n    mem.s.gd_id = \"\"\r\n    mem.s.gd_name = \"\"",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "mem.w.google.set_enabled(num(form.s.datasource)<=1)\r\nmem.w.local.set_enabled(not num(form.s.datasource)<=1)",
   "after_form_closed": "",
   "q2_time": "20240427225727",
   "q2_mode": "u"
  },
  {
   "name": "manuals",
   "title": "\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438",
   "seq": "5",
   "menu_path": "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "*",
   "toolbar": "",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "import webbrowser\r\nwebbrowser.open_new_tab(\"https://docs.google.com/document/d/1tP5UizCqzX47iT8I99_qD2xalwCuoJrYd3Q3JT_OEO0/edit?usp=drive_link\")\r\nreturn False",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240617160122",
   "q2_mode": "u"
  },
  {
   "name": "settings",
   "title": "\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",
   "seq": "4",
   "menu_path": "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "*",
   "toolbar": "",
   "ok_button": "*",
   "cancel_button": "*",
   "view_action": "",
   "form_table": "",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "sk = const.servicekey\r\nif sk:\r\n    mem.s.servicekey = sk\r\nsk = const.service_email\r\nif sk:\r\n    mem.s.service_email = sk",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "const.servicekey = mem.s.servicekey\r\nconst.service_email = mem.s.service_email\r\nif not self.heap.gd_connect(mem.s.servicekey, False):\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!\")",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240618121556",
   "q2_mode": "u"
  },
  {
   "name": "sheet_keys",
   "title": "\u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u0441\u0442\u043e\u043b\u0431\u0435\u0446 \u0442\u0430\u0431\u043b\u0438\u0446\u044b",
   "seq": "2",
   "menu_path": "",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "",
   "toolbar": "",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "sheet_keys",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "def load_docs_row(mem=mem):\r\n    def loader_worker(mem=mem):\r\n        return self.heap.gd. load_sheet_row_dict(get(\"datas\", f\"id = {mem.r.parent_id}\", \"gd_id\"), 0,  mem.r.rownumber)\r\n\r\n    sheet = q2working(loader_worker, \"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445...\")\r\n    data = sheet[list(sheet.keys())[0]][mem.r.rownumber]\r\n    # if get(\"modules\", f\"name='_row_extender'\", \"name\", q2_db=self.db_logic) == '_row_extender':\r\n    try:\r\n        import _row_extender\r\n        row_extender(data, mem.r.parent_id)\r\n    except:\r\n        pass\r\n    return data\r\n    \r\nmem.heap.load_docs_row = load_docs_row",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240617171653",
   "q2_mode": "u"
  },
  {
   "name": "templates",
   "title": "\u0428\u0430\u0431\u043b\u043e\u043d\u044b",
   "seq": "3",
   "menu_path": "",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "",
   "toolbar": "",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "templates",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  }
 ],
 "lines": [
  {
   "id": "122",
   "name": "_test_sheet_keys",
   "column": "saved",
   "label": "Saved to Students",
   "gridlabel": "",
   "seq": "0",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "check",
   "pic": "",
   "datatype": "char",
   "datalen": "1",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240625090119",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "118",
   "name": "_test_sheet_students",
   "column": "id",
   "label": "\u041a\u043e\u0434",
   "gridlabel": "",
   "seq": "0",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "*",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240625120143",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "119",
   "name": "_test_sheet_students",
   "column": "firstname",
   "label": "\u0418\u043c\u044f",
   "gridlabel": "",
   "seq": "1",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "100",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240624223513",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "120",
   "name": "_test_sheet_students",
   "column": "lastname",
   "label": "\u0424\u0430\u043c\u0438\u043b\u0438\u044f",
   "gridlabel": "",
   "seq": "2",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "100",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240624092312",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "121",
   "name": "_test_sheet_students",
   "column": "date_of_birth",
   "label": "\u0414\u0430\u0442\u0430 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "date",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240624092948",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "55",
   "name": "datas",
   "column": "id",
   "label": "",
   "gridlabel": "",
   "seq": "2",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "*",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427215528",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "56",
   "name": "datas",
   "column": "key_column",
   "label": "\u041a\u043b\u044e\u0447\u0435\u0432\u0430\u044f \u043a\u043e\u043b\u043e\u043d\u043a\u0430",
   "gridlabel": "",
   "seq": "26",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "100",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "\u041d\u043e\u043c\u0435\u0440\u0430 \u0438\u043b\u0438 \u0431\u0443\u043a\u0432\u044b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c\u044b\u0445 \u043a\u043e\u043b\u043e\u043d\u043e\u043a<br>\u041c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e, \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0432 \u0441\u0438\u043c\u0432\u043e\u043b\u0430\u043c\u0438 + \u0438\u043b\u0438 , \u0438\u043b\u0438 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u043c",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "57",
   "name": "datas",
   "column": "name",
   "label": "\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0438\u043c\u0435\u043d\u0438",
   "gridlabel": "",
   "seq": "21",
   "nogrid": "*",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "100",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "58",
   "name": "datas",
   "column": "select_file",
   "label": "\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0444\u0430\u0439\u043b",
   "gridlabel": "",
   "seq": "22",
   "nogrid": "*",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\n\r\n\r\nfrom q2rad.q2utils import q2choice\r\nsheets = myapp.heap.gd.dir(f\"mimeType='application/vnd.google-apps.spreadsheet' and name contains '{mem.s.name}'\")\r\nrez = q2choice(\r\n        [{'name':x['name'], 'id':x['id']} for x in sheets],\r\n        title=\"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u0443\",\r\n        column_title=[\"\u0418\u043c\u044f\", \"\u041a\u043e\u0434\"],\r\n    )\r\nif rez:\r\n    mem.s.gd_name = rez['name']\r\n    mem.s.gd_id = rez['id']",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "60",
   "name": "datas",
   "column": "/h",
   "label": "\u041f\u043e\u0438\u0441\u043a \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "20",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "61",
   "name": "datas",
   "column": "first_row",
   "label": "\u041d\u043e\u043c\u0435\u0440 \u043f\u0435\u0440\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438",
   "gridlabel": "",
   "seq": "27",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "62",
   "name": "datas",
   "column": "gd_name",
   "label": "\u0418\u043c\u044f \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "17",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "*",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "250",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "63",
   "name": "datas",
   "column": "gd_id",
   "label": "\u041a\u043e\u0434 \u0444\u0430\u0439\u043b\u0430 \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "14",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "*",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "200",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "64",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "23",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "65",
   "name": "datas",
   "column": "open",
   "label": "\u041e\u0442\u043a\u0440\u044b\u0442\u044c",
   "gridlabel": "",
   "seq": "29",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "15",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "if num(mem.s.datasource) <= 1:\r\n    if self.heap.gd is None:\r\n        q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n        return\r\n\r\n    myapp.heap.gd.open_sheet(mem.s.gd_id)\r\nelse:\r\n    open_document(mem.s.local_path)",
   "q2_time": "20240427230518",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "66",
   "name": "datas",
   "column": "/h",
   "label": "",
   "gridlabel": "",
   "seq": "16",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "67",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "19",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "68",
   "name": "datas",
   "column": "refresh",
   "label": "\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043c\u044f",
   "gridlabel": "",
   "seq": "18",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "15",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\nif mem.s.gd_id:\r\n    mem.s.gd_name = myapp.heap.gd.get(mem.s.gd_id)['name']",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "69",
   "name": "datas",
   "column": "comments",
   "label": "\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f",
   "gridlabel": "",
   "seq": "31",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "text",
   "pic": "",
   "datatype": "text",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "102",
   "name": "datas",
   "column": "local_path",
   "label": "",
   "gridlabel": "Local Excel file",
   "seq": "8",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "250",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427225334",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "103",
   "name": "datas",
   "column": "datasource",
   "label": "Spreadsheet location",
   "gridlabel": "",
   "seq": "4",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "*",
   "readonly": "*",
   "stretch": "0",
   "tag": "",
   "control": "radio",
   "pic": "Google;Local Excel",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "# mem.w.google.set_enabled(num(form.s.datasource)<=1)\r\n# mem.w.local.set_enabled(not num(form.s.datasource)<=1)\r\nmem.form_refresh()",
   "q2_time": "20240625095347",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "104",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "1",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427215528",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "105",
   "name": "datas",
   "column": "/f",
   "label": "Local Excel file",
   "gridlabel": "",
   "seq": "6",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "local",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427223838",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "106",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "10",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427223721",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "107",
   "name": "datas",
   "column": "/v",
   "label": "Google spreadsheet",
   "gridlabel": "",
   "seq": "12",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "google",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "108",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "24",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "109",
   "name": "datas",
   "column": "/f",
   "label": "",
   "gridlabel": "",
   "seq": "13",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "110",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "15",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "111",
   "name": "datas",
   "column": "/h",
   "label": "Path",
   "gridlabel": "",
   "seq": "7",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427223844",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "112",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "11",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "113",
   "name": "datas",
   "column": "/h",
   "label": "",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427215528",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "114",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "5",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427223141",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "115",
   "name": "datas",
   "column": "/h",
   "label": "",
   "gridlabel": "",
   "seq": "25",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "116",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "28",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240427222701",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "117",
   "name": "datas",
   "column": "fdlg",
   "label": "?",
   "gridlabel": "",
   "seq": "9",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "?",
   "datatype": "char",
   "datalen": "2",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "fname = self.get_open_file_dialoq(\"Select Excel file\",\r\n            \"\",\r\n            _(\"Excel file (*.xlsx);\"),\r\n        )\r\nif fname:\r\n    mem.s.local_path  = fname[0]",
   "q2_time": "20240427225317",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "70",
   "name": "settings",
   "column": "servicekey",
   "label": "Service key",
   "gridlabel": "",
   "seq": "2",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "text",
   "pic": "",
   "datatype": "text",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "?123\r\nif mem.s.service_email == \"\":\r\n    try:\r\n        mem.s.service_email = json.loads(mem.s.servicekey).get(\"client_email\", \"\")\r\n    except Exception as error:\r\n        ?error",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "71",
   "name": "settings",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "1",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "73",
   "name": "settings",
   "column": "/h",
   "label": "",
   "gridlabel": "",
   "seq": "8",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "74",
   "name": "settings",
   "column": "/s",
   "label": "",
   "gridlabel": "",
   "seq": "13",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "76",
   "name": "settings",
   "column": "service_email",
   "label": "Service account Email",
   "gridlabel": "",
   "seq": "5",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "200",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "77",
   "name": "settings",
   "column": "",
   "label": "<font color=green><b>\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u043c \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u043d\u0438\u0436\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u043e\u043c \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430",
   "gridlabel": "",
   "seq": "4",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "label",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "78",
   "name": "settings",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "14",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "79",
   "name": "settings",
   "column": "copy",
   "label": "\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c Email \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0433\u043e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430",
   "gridlabel": "",
   "seq": "10",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "self.set_clipboard(mem.s.service_email)",
   "q2_time": "20240618140722",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "80",
   "name": "settings",
   "column": "/s",
   "label": "",
   "gridlabel": "",
   "seq": "9",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "81",
   "name": "settings",
   "column": "",
   "label": "",
   "gridlabel": "",
   "seq": "6",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "label",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "82",
   "name": "settings",
   "column": "/v",
   "label": "\ud83d\udce7",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240618121812",
   "q2_mode": "u",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "83",
   "name": "settings",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "7",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "",
   "pic": "",
   "datatype": "",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "84",
   "name": "sheet_keys",
   "column": "id",
   "label": "",
   "gridlabel": "",
   "seq": "1",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "*",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "85",
   "name": "sheet_keys",
   "column": "parent_id",
   "label": "",
   "gridlabel": "",
   "seq": "2",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "datas",
   "to_column": "id",
   "related": "gd_name",
   "to_form": "datas",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "86",
   "name": "sheet_keys",
   "column": "key_value",
   "label": "\u0422\u0435\u043a\u0441\u0442",
   "gridlabel": "",
   "seq": "4",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "250",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "87",
   "name": "sheet_keys",
   "column": "rownumber",
   "label": "\u2116 \u0441\u0442\u0440\u043e\u043a\u0438",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "88",
   "name": "templates",
   "column": "id",
   "label": "",
   "gridlabel": "",
   "seq": "1",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "*",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "89",
   "name": "templates",
   "column": "parent_id",
   "label": "",
   "gridlabel": "",
   "seq": "2",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "datas",
   "to_column": "id",
   "related": "gd_name",
   "to_form": "datas",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "90",
   "name": "templates",
   "column": "gd_name",
   "label": "\u0418\u043c\u044f \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "*",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "250",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "91",
   "name": "templates",
   "column": "gd_id",
   "label": "\u041a\u043e\u0434 \u0444\u0430\u0439\u043b\u0430 \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "8",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "*",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "200",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "92",
   "name": "templates",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "13",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "93",
   "name": "templates",
   "column": "/h",
   "label": "\u041f\u043e\u0438\u0441\u043a \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430 \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "10",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "94",
   "name": "templates",
   "column": "name",
   "label": "\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0438\u043c\u0435\u043d\u0438",
   "gridlabel": "",
   "seq": "11",
   "nogrid": "*",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "100",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "95",
   "name": "templates",
   "column": "select_file",
   "label": "\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0444\u0430\u0439\u043b",
   "gridlabel": "",
   "seq": "12",
   "nogrid": "*",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\n\r\n\r\nfrom q2rad.q2utils import q2choice\r\nsheets = myapp.heap.gd.dir(f\"mimeType='application/vnd.google-apps.document' and name contains '{mem.s.name}'\")\r\nrez = q2choice(\r\n        [{'name':x['name'], 'id':x['id']} for x in sheets],\r\n        title=\"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\",\r\n        column_title=[\"\u0418\u043c\u044f\", \"\u041a\u043e\u0434\"],\r\n    )\r\nif rez:\r\n    mem.s.gd_name = rez['name']\r\n    mem.s.gd_id = rez['id']",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "96",
   "name": "templates",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "9",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "97",
   "name": "templates",
   "column": "/h",
   "label": "",
   "gridlabel": "",
   "seq": "4",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "98",
   "name": "templates",
   "column": "open",
   "label": "\u041e\u0442\u043a\u0440\u044b\u0442\u044c",
   "gridlabel": "",
   "seq": "5",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "15",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\n\r\nmyapp.heap.gd.open_document(mem.s.gd_id)",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "99",
   "name": "templates",
   "column": "refresh",
   "label": "\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043c\u044f",
   "gridlabel": "",
   "seq": "6",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "15",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\n\r\nif mem.s.gd_id:\r\n    mem.s.gd_name = myapp.heap.gd.get(mem.s.gd_id)['name']",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "100",
   "name": "templates",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "7",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  },
  {
   "id": "101",
   "name": "templates",
   "column": "comments",
   "label": "\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f",
   "gridlabel": "",
   "seq": "14",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "text",
   "pic": "",
   "datatype": "text",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240324204712",
   "q2_mode": "i",
   "mess": "",
   "alignment": "0",
   "style": ""
  }
 ],
 "queries": [
  {
   "name": "3333",
   "content": "{\n  \"queries\": {\n    \"new_query\": \"select * from \"\n  },\n  \"params\": {}\n}",
   "comment": "",
   "q2_time": "20240616203429",
   "q2_mode": "i"
  }
 ],
 "actions": [
  {
   "id": "26",
   "name": "_test_sheet_keys",
   "action_text": "Test",
   "seq": "0",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "q2mess(\"Test\")",
   "comment": "",
   "q2_time": "20240623182044",
   "q2_mode": "i"
  },
  {
   "id": "27",
   "name": "_test_sheet_students",
   "action_text": "",
   "seq": "0",
   "action_mode": "1",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "0",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240624092202",
   "q2_mode": "i"
  },
  {
   "id": "16",
   "name": "datas",
   "action_text": "",
   "seq": "0",
   "action_mode": "1",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  },
  {
   "id": "17",
   "name": "datas",
   "action_text": "\u0421\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435",
   "seq": "2",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "sheet_keys",
   "child_where": "parent_id={id}",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  },
  {
   "id": "18",
   "name": "datas",
   "action_text": "\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c",
   "seq": "3",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "F3",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\n\r\nself.heap.gd.open_sheets() \r\n\r\ndef worker(mem=mem):\r\n    def parse_col(col_string=\"\"):\r\n        def get_ncol(letter=\"AB3\"):\r\n            if letter.isdigit():\r\n                return int(letter)\r\n            if letter.isalpha():\r\n                rez = 0\r\n                for pos, char in enumerate(reversed(letter)):\r\n                    rez += (ord(char) - 65) + 26**pos\r\n                return rez\r\n        rez = []\r\n        for x in [get_ncol(x) for x in re.split(r\"\\W+\", col_string.upper())]:\r\n            if x is not None and x not in rez:\r\n                rez.append(x)\r\n        return rez\r\n    \r\n    cols = parse_col(mem.r.key_column)\r\n    sh = self.heap.gd.google_sheets.open_by_key(mem.r.gd_id)\r\n    worksheet = sh.get_worksheet(0)\r\n    allrows = {}\r\n    for col in cols:\r\n        allrows[col] = worksheet.col_values(col)\r\n\r\n    rows = {}\r\n    for x in allrows:\r\n        for index, value in enumerate(allrows[x]):\r\n            if index not in rows:\r\n                rows[index] = {}\r\n            rows[index][x] = value\r\n    return rows\r\n\r\ntry:\r\n    allrows = q2working(worker, \"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0442\u0430\u0431\u043b\u0438\u0446\u044b\")\r\nexcept Exception as error:\r\n    q2mess(f\"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u044b:<br><br>{error}\")\r\n    return\r\n    \r\n\r\nwait = Q2WaitShow(\"\u0417\u0430\u043f\u0438\u0441\u044c \u0441\u0442\u0440\u043e\u043a\", len(allrows))\r\nq2cursor(f\"delete from sheet_keys where parent_id ={mem.r.id}\")\r\ntransaction()\r\nfor row in allrows.items():\r\n    wait.step()\r\n    if row[0] < int_(mem.r.first_row) - 1:\r\n        continue\r\n    keystring = \" ; \".join([x for x in row[1].values()])\r\n    insert(\"sheet_keys\", {\"rownumber\": row[0] + 1, \r\n               \"key_value\": keystring,\r\n               \"parent_id\": mem.r.id})\r\ncommit()\r\nrun_module(\"_after_data_loaded\", _locals=locals())\r\nwait.close()\r\nmem.refresh()",
   "comment": "",
   "q2_time": "20240625134152",
   "q2_mode": "u"
  },
  {
   "id": "19",
   "name": "datas",
   "action_text": "\u041e\u0442\u043a\u0440\u044b\u0442\u044c",
   "seq": "4",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "if num(mem.r.datasource) <= 1:\r\n    if self.heap.gd is None:\r\n        q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n        return\r\n\r\n    myapp.heap.gd.open_sheet(mem.r.gd_id)\r\n\r\nelse:\r\n    open_document(mem.r.local_path)",
   "comment": "",
   "q2_time": "20240427230643",
   "q2_mode": "u"
  },
  {
   "id": "20",
   "name": "datas",
   "action_text": "\u0428\u0430\u0431\u043b\u043e\u043d\u044b",
   "seq": "5",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "templates",
   "child_where": "parent_id={id}",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  },
  {
   "id": "21",
   "name": "sheet_keys",
   "action_text": "\u0421\u043b\u0438\u044f\u043d\u0438\u0435",
   "seq": "1",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "select",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\n\r\n\r\nfrom q2rad.q2utils import q2choice\r\ncu = q2cursor(f\"select gd_name as name, gd_id as id from templates where parent_id={mem.r.parent_id}\")\r\nif cu.row_count() > 1:\r\n    choice = q2choice([x for x in cu.records()],\r\n                                \"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0448\u0430\u0431\u043b\u043e\u043d \u0434\u043b\u044f \u0441\u043b\u0438\u044f\u043d\u0438\u044f\",\r\n                                ['\u0418\u043c\u044f', '\u041a\u043e\u0434'])\r\nelse:\r\n    choice = cu.record(0)\r\n\r\nif choice:\r\n    sheet = mem.heap.load_docs_row()\r\n    def merge_worker(sheet=sheet, choice=choice):\r\n        d2d=q2data2docx()\r\n        d2d.setJsonBinary(json.dumps(sheet))\r\n        d2d.setDocxTemplateBinary(self.heap.gd.load_docs(choice['id']))\r\n        if d2d.merge():\r\n            d2d.saveFile(\"temp/repo.docx\")\r\n    q2working(merge_worker, \"\u0421\u043b\u0438\u044f\u043d\u0438\u0435...\")",
   "comment": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  },
  {
   "id": "22",
   "name": "sheet_keys",
   "action_text": "",
   "seq": "3",
   "action_mode": "1",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  },
  {
   "id": "23",
   "name": "sheet_keys",
   "action_text": "\u0414\u0430\u043d\u043d\u044b\u0435",
   "seq": "2",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\n\r\nq2mess(mem.heap.load_docs_row())",
   "comment": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  },
  {
   "id": "24",
   "name": "templates",
   "action_text": "",
   "seq": "1",
   "action_mode": "1",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  },
  {
   "id": "25",
   "name": "templates",
   "action_text": "\u041e\u0442\u043a\u0440\u044b\u0442\u044c",
   "seq": "2",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "if self.heap.gd is None:\r\n    q2mess(\"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0413\u0443\u0433\u043b \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e!<br>\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\")\r\n    return\r\n\r\nmyapp.heap.gd.open_document(mem.r.gd_id)",
   "comment": "",
   "q2_time": "20240324204712",
   "q2_mode": "i"
  }
 ],
 "reports": [
  {
   "name": "323",
   "content": "{\n  \"queries\": {\n    \"new_query\": \"select * from \"\n  },\n  \"params\": {},\n  \"pages\": [\n    {\n      \"columns\": [\n        {\n          \"rows\": [\n            {\n              \"role\": \"free\",\n              \"data_source\": \"\",\n              \"groupby\": \"\",\n              \"table_groups\": [],\n              \"print_when\": \"\",\n              \"print_after\": \"\",\n              \"new_page_before\": \"\",\n              \"new_page_after\": \"\",\n              \"heights\": [\n                \"0-0\"\n              ],\n              \"cells\": {}\n            }\n          ],\n          \"widths\": [\n            \"50%\",\n            \"2\",\n            \"0\"\n          ]\n        }\n      ],\n      \"page_width\": 21.0,\n      \"page_height\": 29.0,\n      \"page_margin_left\": 2.0,\n      \"page_margin_top\": 2.0,\n      \"page_margin_right\": 1.0,\n      \"page_margin_bottom\": 2.0\n    }\n  ],\n  \"style\": {\n    \"font-family\": \"Arial\",\n    \"font-size\": \"8pt\",\n    \"font-weight\": \"normal\",\n    \"border-width\": \"0 0 0 0\",\n    \"padding\": \"0.05cm 0.05cm 0.05cm 0.05cm\",\n    \"text-align\": \"left\",\n    \"vertical-align\": \"top\"\n  }\n}",
   "comment": "",
   "q2_time": "20240616203453",
   "q2_mode": "i"
  }
 ],
 "packages": [
  {
   "package_name": "q2googledrive",
   "package_version": "",
   "comment": "",
   "q2_time": "20240304122315",
   "q2_mode": "i",
   "package_alias": "",
   "package_pipname": ""
  }
 ]
}