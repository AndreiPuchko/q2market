{
 "modules": [
  {
   "name": "_test_",
   "script": "id = \"19xpPvbIqVZ2ITveS-DUI3vwSBnSWPXc3qWc1NYtRREs\"\r\n\r\nself.heap.gd.open_sheets()\r\n\r\nsh = self.heap.gd.google_sheets.open_by_key(id)\r\n\r\nworksheet = sh.get_worksheet(0)\r\n\r\nallrows = worksheet.get_all_values()\r\n\r\n\r\nfor x in allrows:\r\n    ?x",
   "comment": "",
   "last_line": "13",
   "q2_time": "20240301180555",
   "q2_mode": "u"
  },
  {
   "name": "autorun",
   "script": "self.heap.gd = None\r\nif self.heap.gd is None and len(const.secrets) != 0 and len(const.token) !=0:\r\n    self.heap.gd = q2googledrive(token=const.token, secrets=const.secrets)\r\n    if self.heap.gd.drive is None:\r\n        self.heap.gd = None",
   "comment": "",
   "last_line": "6",
   "q2_time": "20240302002604",
   "q2_mode": "u"
  },
  {
   "name": "manifest",
   "script": "myapp.app_title = \"GoogleDriveMerge\"\nmyapp.app_description = \"Merges one row from Google Sheet into Google Document template\"\nmyapp.app_url = \"https://raw.githubusercontent.com/AndreiPuchko/q2market/main/GoogleDriveMerge\"",
   "comment": "",
   "last_line": "3",
   "q2_time": "20240302200635",
   "q2_mode": "u"
  },
  {
   "name": "version",
   "script": "self.app_version = '2024-03-02 20:07:14'",
   "comment": "",
   "last_line": "0",
   "q2_time": "20240302200714",
   "q2_mode": "i"
  }
 ],
 "forms": [
  {
   "name": "datas",
   "title": "\u0422\u0430\u0431\u043b\u0438\u0446\u044b",
   "seq": "1",
   "menu_path": "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "",
   "toolbar": "*",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "datas",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "if mem.crud_mode == \"NEW\":\r\n    mem.s.key_column = 1\r\n    mem.s.first_row = 2\r\n# if mem.crud_mode != \"NEW\":\r\n    # mem.w.name.set_visible(False)\r\n    # mem.w.name.label.set_visible(False)\r\n    # mem.w.select_file.set_visible(False)\r\n# mem.s.name = \"Pri\"",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240302003457",
   "q2_mode": "u"
  },
  {
   "name": "settings",
   "title": "\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",
   "seq": "4",
   "menu_path": "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "*",
   "toolbar": "",
   "ok_button": "*",
   "cancel_button": "*",
   "view_action": "",
   "form_table": "",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "secrets = const.secrets\r\nif secrets:\r\n    mem.s.secrets = secrets\r\ntoken = const.token\r\nif token:\r\n    mem.s.token = token",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "const.secrets = mem.s.secrets\r\nconst.token = mem.s.token",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240301201650",
   "q2_mode": "u"
  },
  {
   "name": "sheet_keys",
   "title": "\u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u0441\u0442\u043e\u043b\u0431\u0435\u0446 \u0442\u0430\u0431\u043b\u0438\u0446\u044b",
   "seq": "2",
   "menu_path": "",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "",
   "toolbar": "",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "sheet_keys",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240301173423",
   "q2_mode": "u"
  },
  {
   "name": "templates",
   "title": "\u0428\u0430\u0431\u043b\u043e\u043d\u044b",
   "seq": "3",
   "menu_path": "",
   "menu_text": "",
   "menu_before": "",
   "menu_icon": "",
   "menu_tiptext": "",
   "menu_separator": "",
   "toolbar": "",
   "ok_button": "",
   "cancel_button": "",
   "view_action": "",
   "form_table": "templates",
   "form_table_sort": "",
   "comment": "",
   "before_form_build": "",
   "before_grid_build": "",
   "before_grid_show": "",
   "after_grid_show": "",
   "before_form_show": "",
   "after_form_show": "",
   "before_crud_save": "",
   "after_crud_save": "",
   "before_delete": "",
   "after_delete": "",
   "form_valid": "",
   "form_refresh": "",
   "after_form_closed": "",
   "q2_time": "20240301201650",
   "q2_mode": "u"
  }
 ],
 "lines": [
  {
   "id": "1",
   "name": "datas",
   "column": "id",
   "label": "",
   "gridlabel": "",
   "seq": "0",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "*",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301143838",
   "q2_mode": "i"
  },
  {
   "id": "4",
   "name": "datas",
   "column": "key_column",
   "label": "\u041d\u043e\u043c\u0435\u0440 \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0438",
   "gridlabel": "",
   "seq": "7",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235348",
   "q2_mode": "u"
  },
  {
   "id": "13",
   "name": "datas",
   "column": "name",
   "label": "\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0438\u043c\u0435\u043d\u0438",
   "gridlabel": "",
   "seq": "11",
   "nogrid": "*",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "100",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235347",
   "q2_mode": "u"
  },
  {
   "id": "14",
   "name": "datas",
   "column": "select_file",
   "label": "\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0444\u0430\u0439\u043b",
   "gridlabel": "",
   "seq": "12",
   "nogrid": "*",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "from q2utils import q2choice\r\nsheets = myapp.heap.gd.dir(f\"mimeType='application/vnd.google-apps.spreadsheet' and name contains '{mem.s.name}'\")\r\nrez = q2choice(\r\n        [{'name':x['name'], 'id':x['id']} for x in sheets],\r\n        title=\"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u0443\",\r\n        column_title=[\"\u0418\u043c\u044f\", \"\u041a\u043e\u0434\"],\r\n    )\r\nif rez:\r\n    mem.s.gd_name = rez['name']\r\n    mem.s.gd_id = rez['id']",
   "q2_time": "20240301235347",
   "q2_mode": "u"
  },
  {
   "id": "15",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "9",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235348",
   "q2_mode": "u"
  },
  {
   "id": "16",
   "name": "datas",
   "column": "/h",
   "label": "\u041f\u043e\u0438\u0441\u043a \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "10",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235348",
   "q2_mode": "u"
  },
  {
   "id": "21",
   "name": "datas",
   "column": "first_row",
   "label": "\u041d\u043e\u043c\u0435\u0440 \u043f\u0435\u0440\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438",
   "gridlabel": "",
   "seq": "8",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235348",
   "q2_mode": "u"
  },
  {
   "id": "26",
   "name": "datas",
   "column": "gd_name",
   "label": "\u0418\u043c\u044f \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "0",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "*",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "250",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301200740",
   "q2_mode": "i"
  },
  {
   "id": "27",
   "name": "datas",
   "column": "gd_id",
   "label": "\u041a\u043e\u0434 \u0444\u0430\u0439\u043b\u0430 \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "6",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "*",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "200",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235348",
   "q2_mode": "u"
  },
  {
   "id": "30",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "13",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235347",
   "q2_mode": "u"
  },
  {
   "id": "36",
   "name": "datas",
   "column": "open",
   "label": "\u041e\u0442\u043a\u0440\u044b\u0442\u044c",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "15",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "myapp.heap.gd.open_sheet(mem.s.gd_id)",
   "q2_time": "20240302001112",
   "q2_mode": "u"
  },
  {
   "id": "37",
   "name": "datas",
   "column": "/h",
   "label": "",
   "gridlabel": "",
   "seq": "0",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235300",
   "q2_mode": "u"
  },
  {
   "id": "38",
   "name": "datas",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "5",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301235349",
   "q2_mode": "u"
  },
  {
   "id": "39",
   "name": "datas",
   "column": "refresh",
   "label": "\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043c\u044f",
   "gridlabel": "",
   "seq": "4",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "15",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "mem.s.gd_name = myapp.heap.gd.get(mem.s.gd_id)['name']",
   "q2_time": "20240302001002",
   "q2_mode": "u"
  },
  {
   "id": "44",
   "name": "datas",
   "column": "comments",
   "label": "\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f",
   "gridlabel": "",
   "seq": "14",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "text",
   "pic": "",
   "datatype": "text",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161118",
   "q2_mode": "i"
  },
  {
   "id": "5",
   "name": "settings",
   "column": "secrets",
   "label": "\u0421\u0435\u043a\u0440\u0435\u0442",
   "gridlabel": "",
   "seq": "2",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "text",
   "pic": "",
   "datatype": "text",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301201653",
   "q2_mode": "u"
  },
  {
   "id": "6",
   "name": "settings",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "1",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301201653",
   "q2_mode": "u"
  },
  {
   "id": "7",
   "name": "settings",
   "column": "token",
   "label": "\u0422\u043e\u043a\u0435\u043d",
   "gridlabel": "",
   "seq": "8",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "text",
   "pic": "",
   "datatype": "text",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301201653",
   "q2_mode": "u"
  },
  {
   "id": "8",
   "name": "settings",
   "column": "connect",
   "label": "Connect",
   "gridlabel": "",
   "seq": "5",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "self.heap.gd = q2googledrive(token=mem.s.token, secrets=mem.s.secrets)\r\nself.heap.gd.login()\r\nconst.token=self.heap.gd.token.to_json()",
   "q2_time": "20240301201653",
   "q2_mode": "u"
  },
  {
   "id": "9",
   "name": "settings",
   "column": "/h",
   "label": "",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301201653",
   "q2_mode": "u"
  },
  {
   "id": "10",
   "name": "settings",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "7",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301201653",
   "q2_mode": "u"
  },
  {
   "id": "11",
   "name": "settings",
   "column": "/s",
   "label": "",
   "gridlabel": "",
   "seq": "6",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301201653",
   "q2_mode": "u"
  },
  {
   "id": "12",
   "name": "settings",
   "column": "/s",
   "label": "",
   "gridlabel": "",
   "seq": "4",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301201653",
   "q2_mode": "u"
  },
  {
   "id": "17",
   "name": "sheet_keys",
   "column": "id",
   "label": "",
   "gridlabel": "",
   "seq": "1",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "*",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301172241",
   "q2_mode": "u"
  },
  {
   "id": "18",
   "name": "sheet_keys",
   "column": "parent_id",
   "label": "",
   "gridlabel": "",
   "seq": "2",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "datas",
   "to_column": "id",
   "related": "gd_name",
   "to_form": "datas",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301172241",
   "q2_mode": "u"
  },
  {
   "id": "19",
   "name": "sheet_keys",
   "column": "key_value",
   "label": "\u0422\u0435\u043a\u0441\u0442",
   "gridlabel": "",
   "seq": "4",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "250",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240301172241",
   "q2_mode": "u"
  },
  {
   "id": "20",
   "name": "sheet_keys",
   "column": "rownumber",
   "label": "\u2116 \u0441\u0442\u0440\u043e\u043a\u0438",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302003328",
   "q2_mode": "u"
  },
  {
   "id": "22",
   "name": "templates",
   "column": "id",
   "label": "",
   "gridlabel": "",
   "seq": "1",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "*",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161219",
   "q2_mode": "u"
  },
  {
   "id": "23",
   "name": "templates",
   "column": "parent_id",
   "label": "",
   "gridlabel": "",
   "seq": "2",
   "nogrid": "*",
   "noform": "*",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "int",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "datas",
   "to_column": "id",
   "related": "gd_name",
   "to_form": "datas",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161228",
   "q2_mode": "u"
  },
  {
   "id": "28",
   "name": "templates",
   "column": "gd_name",
   "label": "\u0418\u043c\u044f \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "3",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "*",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "250",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161228",
   "q2_mode": "u"
  },
  {
   "id": "29",
   "name": "templates",
   "column": "gd_id",
   "label": "\u041a\u043e\u0434 \u0444\u0430\u0439\u043b\u0430 \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "8",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "*",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "200",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161229",
   "q2_mode": "u"
  },
  {
   "id": "31",
   "name": "templates",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "13",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161231",
   "q2_mode": "u"
  },
  {
   "id": "32",
   "name": "templates",
   "column": "/h",
   "label": "\u041f\u043e\u0438\u0441\u043a \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430 \u043d\u0430 \u0413\u0443\u0433\u043b\u0414\u0438\u0441\u043a\u0435",
   "gridlabel": "",
   "seq": "10",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161230",
   "q2_mode": "u"
  },
  {
   "id": "33",
   "name": "templates",
   "column": "name",
   "label": "\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442 \u0438\u043c\u0435\u043d\u0438",
   "gridlabel": "",
   "seq": "11",
   "nogrid": "*",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "100",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161230",
   "q2_mode": "u"
  },
  {
   "id": "34",
   "name": "templates",
   "column": "select_file",
   "label": "\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0444\u0430\u0439\u043b",
   "gridlabel": "",
   "seq": "12",
   "nogrid": "*",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "from q2utils import q2choice\r\nsheets = myapp.heap.gd.dir(f\"mimeType='application/vnd.google-apps.document' and name contains '{mem.s.name}'\")\r\nrez = q2choice(\r\n        [{'name':x['name'], 'id':x['id']} for x in sheets],\r\n        title=\"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\",\r\n        column_title=[\"\u0418\u043c\u044f\", \"\u041a\u043e\u0434\"],\r\n    )\r\nif rez:\r\n    mem.s.gd_name = rez['name']\r\n    mem.s.gd_id = rez['id']",
   "q2_time": "20240302161439",
   "q2_mode": "u"
  },
  {
   "id": "35",
   "name": "templates",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "9",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161230",
   "q2_mode": "u"
  },
  {
   "id": "40",
   "name": "templates",
   "column": "/h",
   "label": "",
   "gridlabel": "",
   "seq": "4",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161228",
   "q2_mode": "u"
  },
  {
   "id": "41",
   "name": "templates",
   "column": "open",
   "label": "\u041e\u0442\u043a\u0440\u044b\u0442\u044c",
   "gridlabel": "",
   "seq": "5",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "15",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "myapp.heap.gd.open_document(mem.s.gd_id)",
   "q2_time": "20240302161229",
   "q2_mode": "u"
  },
  {
   "id": "42",
   "name": "templates",
   "column": "refresh",
   "label": "\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043c\u044f",
   "gridlabel": "",
   "seq": "6",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "button",
   "pic": "",
   "datatype": "char",
   "datalen": "15",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "mem.s.gd_name = myapp.heap.gd.get(mem.s.gd_id)['name']",
   "q2_time": "20240302161229",
   "q2_mode": "u"
  },
  {
   "id": "43",
   "name": "templates",
   "column": "/",
   "label": "",
   "gridlabel": "",
   "seq": "7",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "line",
   "pic": "",
   "datatype": "char",
   "datalen": "0",
   "datadec": "0",
   "migrate": "",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161229",
   "q2_mode": "u"
  },
  {
   "id": "45",
   "name": "templates",
   "column": "comments",
   "label": "\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f",
   "gridlabel": "",
   "seq": "14",
   "nogrid": "",
   "noform": "",
   "check": "",
   "disabled": "",
   "readonly": "",
   "stretch": "0",
   "tag": "",
   "control": "text",
   "pic": "",
   "datatype": "text",
   "datalen": "0",
   "datadec": "0",
   "migrate": "*",
   "pk": "",
   "ai": "",
   "to_table": "",
   "to_column": "",
   "related": "",
   "to_form": "",
   "comment": "",
   "code_when": "",
   "code_show": "",
   "code_valid": "",
   "q2_time": "20240302161231",
   "q2_mode": "u"
  }
 ],
 "queries": [],
 "actions": [
  {
   "id": "1",
   "name": "datas",
   "action_text": "",
   "seq": "0",
   "action_mode": "1",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240301144524",
   "q2_mode": "i"
  },
  {
   "id": "2",
   "name": "datas",
   "action_text": "\u0421\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435",
   "seq": "2",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "sheet_keys",
   "child_where": "parent_id={id}",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240301211439",
   "q2_mode": "u"
  },
  {
   "id": "3",
   "name": "datas",
   "action_text": "\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c",
   "seq": "3",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "self.heap.gd.open_sheets() \r\n\r\ndef worker(mem=mem):\r\n    sh = self.heap.gd.google_sheets.open_by_key(mem.r.gd_id)\r\n    worksheet = sh.get_worksheet(0) \r\n    allrows = worksheet.col_values(int_(mem.r.key_column) )\r\n    return allrows\r\n\r\nallrows = q2working(worker, \"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0442\u0430\u0431\u043b\u0438\u0446\u044b\")\r\n\r\nif len(allrows) == 0:\r\n    return\r\n\r\nwait = Q2WaitShow(\"\u0417\u0430\u043f\u0438\u0441\u044c \u0441\u0442\u0440\u043e\u043a\", len(allrows))\r\nq2cursor(f\"delete from sheet_keys where parent_id ={mem.r.id}\")\r\ntransaction()\r\nfor index, row in enumerate(allrows):\r\n    wait.step()\r\n    if index < int_(mem.r.first_row) - 1:\r\n        continue\r\n    insert(\"sheet_keys\", {\"rownumber\": index + 1, \r\n               \"key_value\":row,\r\n               \"parent_id\": mem.r.id})\r\ncommit()\r\nwait.close()\r\nmem.refresh()",
   "comment": "",
   "q2_time": "20240302134608",
   "q2_mode": "u"
  },
  {
   "id": "5",
   "name": "datas",
   "action_text": "\u041e\u0442\u043a\u0440\u044b\u0442\u044c",
   "seq": "4",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "myapp.heap.gd.open_sheet(mem.r.gd_id)",
   "comment": "",
   "q2_time": "20240302133733",
   "q2_mode": "u"
  },
  {
   "id": "8",
   "name": "datas",
   "action_text": "\u0428\u0430\u0431\u043b\u043e\u043d\u044b",
   "seq": "5",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "templates",
   "child_where": "parent_id={id}",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240301211438",
   "q2_mode": "u"
  },
  {
   "id": "12",
   "name": "sheet_keys",
   "action_text": "\u0421\u043b\u0438\u044f\u043d\u0438\u0435",
   "seq": "1",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "select",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "from q2utils import q2choice\r\ncu = q2cursor(f\"select gd_name as name, gd_id as id from templates where parent_id={mem.r.parent_id}\")\r\nif cu.row_count() > 1:\r\n    choice = q2choice([x for x in cu.records()],      \r\n            \"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0448\u0430\u0431\u043b\u043e\u043d \u0434\u043b\u044f \u0441\u043b\u0438\u044f\u043d\u0438\u044f\",         \r\n            ['\u0418\u043c\u044f', '\u041a\u043e\u0434'] )\r\nelse:\r\n    choice = cu.record(0)\r\n\r\nif choice:\r\n    \r\n    def worker(choice=choice, mem=mem):\r\n        row = self.heap.gd. load_sheet_row_dict(get(\"datas\", f\"id = {mem.r.parent_id}\", \"gd_id\"), 0,  mem.r.rownumber)\r\n\r\n        if len(row) == 0:\r\n            return\r\n        \r\n        d2d=q2data2docx()\r\n        d2d.setJsonBinary(json.dumps(row))\r\n        d2d.setDocxTemplateBinary(self.heap.gd.load_docs(choice['id']))\r\n        if d2d.merge():\r\n            d2d.saveFile(\"temp/repo.docx\")\r\n    q2working(worker, \"\u0421\u043b\u0438\u044f\u043d\u0438\u0435...\")",
   "comment": "",
   "q2_time": "20240302160554",
   "q2_mode": "u"
  },
  {
   "id": "7",
   "name": "templates",
   "action_text": "",
   "seq": "1",
   "action_mode": "1",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "",
   "comment": "",
   "q2_time": "20240301201625",
   "q2_mode": "i"
  },
  {
   "id": "10",
   "name": "templates",
   "action_text": "\u041e\u0442\u043a\u0440\u044b\u0442\u044c",
   "seq": "2",
   "action_mode": "2",
   "action_mess": "",
   "action_icon": "",
   "action_key": "",
   "tag": "",
   "eof_disabled": "*",
   "child_form": "",
   "child_where": "",
   "child_noshow": "",
   "child_copy_mode": "1",
   "action_worker": "myapp.heap.gd.open_document(mem.r.gd_id)",
   "comment": "",
   "q2_time": "20240302134945",
   "q2_mode": "u"
  }
 ],
 "reports": [],
 "packages": []
}